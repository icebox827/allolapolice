function get_google_fonts(){$gf("#load-more").show(),$list_wrapper=$gf("#fonts-list-wrapper");var a=$list_wrapper.attr("data-gstart"),b=$list_wrapper.attr("data-gfetch"),c=$gf("#search_gfont").val(),d={action:"get_google_fonts",start:a,fetch:b,search:c,security:uavc.get_google_fonts};$gf.post(ajaxurl,d,function(c){var d=jQuery.parseJSON(c),e=d.fonts_count,f=d.fonts,g=d.is_search;if(0==e&&"false"==g){var h='<div class="gfont">It seems you don\'t have any Google Fonts yet. But you can download them now with <a href="javascript:void(0)" id="refresh-google-fonts">just a click.</a> <span class="spinner"></span></div>';$list_wrapper.html(h)}else if(0==f.length){var h='<div class="gfont">';h+="Bummer, there are no font families that match. Try with other search keyword",h+="</div>",$list_wrapper.html(h)}else{var h=convert_json_to_html(f);$list_wrapper.append(h)}$gf("#load-more").hide(),$list_wrapper.attr("data-gstart",parseInt(a)+parseInt(b))})}function convert_json_to_html(a){var b="";return $gf.each(a,function(a,c){var d=c.font_call,e=c.font_name,f=c.variants,g=c.subsets,h=c.selected;if(temp=e.split(" ")){var i=temp.length,j="";$gf.each(temp,function(a,b){j+=b,i-1!=a&&(j+="-")})}else var j=e;var k=f.length,l=g.length;if("true"==h)var m="Added in collection",n="font-added";else var m="Add to Collection",n="";b+='<div class="gfont">',b+='<div class="font-header" style="font-family:\''+e+"'\">"+e+"</div>",b+='<input type="button" class="add-google-font alignright '+n+'" data-font_family="'+d+'" data-font_name="'+e+'" value="'+m+'"/><span class="spinner"></span><div class="clear"></div>',k>1&&(d+=":",b+='<span class="variants">',$gf.each(f,function(a,c){if("regular"!=c){var f="font-family:'"+e+"';";/italic/i.test(c)&&(f+="font-style:italic;");var g="normal";(g=c.match(/\d+/))&&(f+="font-weight:"+g+";"),b+='<span class="font-variant">',b+='<input type="checkbox" class="font-variant-inputs" value="'+c+'" id="'+j+"-"+c+"-"+a+'"/>',b+='<label for="'+j+"-"+c+"-"+a+'" style="'+f+'">'+c+"</label>",b+="</span>",d+=c,k>0&&k-1!=a&&(d+=",")}}),b+="</span>"),l>1&&(b+='<span class="subsets">',$gf.each(g,function(a,c){b+='<span class="font-subset">',b+='<input type="checkbox" class="font-subset-inputs" value="'+c+'" id="'+j+"-"+c+"-"+a+'"/>',b+="</span>"}),b+="</span>"),b+='<div class="clear"></div>',b+="</div>",$gf("head").append('<link href="//fonts.googleapis.com/css?family='+d+'" type="text/css" media="all" rel="stylesheet"/>')}),b}function search_gfont(){var a=$gf("#search_gfont").val();$list_wrapper=$gf("#fonts-list-wrapper"),$list_wrapper.html(""),""==a&&$list_wrapper.attr("data-gstart",parseInt(0)),get_google_fonts()}function set_wrap_height(a){var b=$gf(window).height();if("notfixed"==a)var c=$gf("#fonts-selected-wrapper").offset().top,d=b-c-40;else var d=b-140;$gf("#fonts-selected-wrapper").height(d)}$gf=jQuery.noConflict(),$gf(document).ready(function(){$gf("body").on("click","#refresh-google-fonts",function(){$gf(this).next(".spinner").css({display:"inline-block",float:"none","vertical-align":"middle",visibility:"visible"});var a={action:"ultimate_google_fonts_refresh",security:uavc.google_font_nonce};$gf.post(ajaxurl,a,function(a){var b=jQuery.parseJSON(a),c=b.count,d=b.message;if(0==c)var e=d;else{var e=d+" Please wait, Page is reloading.";window.location.reload(!0)}$gf("#vc-gf-msg").html('<div class="updated">'+e+"</div>").hide(),$gf("#vc-gf-msg").slideDown(300),$gf("#refresh-google-fonts").next(".spinner").css({display:"none"}),setTimeout(function(){$gf("#vc-gf-msg").slideUp(300)},4e3)})}),$gf("body").on("click",".add-google-font",function(){var a=$gf(this),b=$gf(this).attr("data-font_family"),c=$gf(this).attr("data-font_name");if(!a.hasClass("font-added")){a.next(".spinner").show(),a.next(".spinner").css({float:"right",visibility:"visible"});var d=new Array,e=new Array;a.parent().find(".variants").find(".font-variant").each(function(a,b){$v=$gf(b);var c={},e=$v.find(".font-variant-inputs").val();c.variant_value=e,$v.find(".font-variant-inputs").is(":checked")?c.variant_selected=!0:c.variant_selected=!1,d.push(c)}),a.parent().find(".subsets").find(".font-subset").each(function(a,b){$s=$gf(b);var c={},d=$s.find(".font-subset-inputs").val();c.subset_value=d,$s.find(".font-subset-inputs").is(":checked")?c.subset_selected=!0:c.subset_selected=!1,e.push(c)});var f={action:"add_google_font",font_family:b,font_name:c,variants:d,subsets:e,security:uavc.add_google_fonts};$gf.post(ajaxurl,f,function(b){if(a.next(".spinner").hide(),a.val("Added in collection"),a.addClass("font-added"),d.length>0||e.length>0)var f="have-variants";else var f="";var g='<div class="selected-font"><div class="selected-font-top fopened '+f+'"><div class="font-header" style="font-family:\''+c+"'\">"+c+"</div>";if(d.length>0&&(g+='<i class="dashicons dashicons-arrow-down"></i>'),g+='<div class="clear"></div></div><span class="font-delete" data-font_name="'+c+'"><i class="dashicons dashicons-no-alt"></i></span>',d.length>0||e.length>0){if(g+='<div class="selected-font-content" style="display:block">',temp=c.split(" ")){var h=temp.length,i="";$gf.each(temp,function(a,b){i+=b,h-1!=a&&(i+="-")})}else var i=c;var j="";d.length>0&&(g+='<div class="selected-font-varient-wrapper">',$gf.each(d,function(a,b){var d=i+"-dynamic-"+b.variant_value+"-"+a,e="font-family:'"+c+"';";/italic/i.test(b.variant_value)&&(e+="font-style:italic;");var f="normal";(f=b.variant_value.match(/\d+/))&&(e+="font-weight:"+f+";"),g+='<span class="font-variant"><input type="checkbox" id="'+d+'" value="'+b.variant_value+'" class="selected-variant-checkbox" /><label style="'+e+'" for="'+d+'">'+b.variant_value+"</label></span>"}),g+="</div>",j="selected-font-subset-wrapper"),e.length>0&&(g+='<div class="'+j+'">',$gf.each(e,function(a,b){var c=i+"-dynamic-subset-"+b.subset_value+"-"+a;g+='<span class="font-subset"><input type="checkbox" id="'+c+'" value="'+b.subset_value+'" class="selected-subset-checkbox" /><label for="'+c+'">'+b.subset_value+"</label></span>"}),g+="</div>"),g+='<input type="button" class="button alignleft update-google-font-button" value="Update font" data-font_name="'+c+'" /><span class="spinner fspinner"></span><div class="clear"></div></div>'}g+="</div>",$gf("#fonts-selected-wrapper").prepend(g)})}}),$gf("body").on("click",".font-delete",function(){$gf(".google-font-overlay").remove(),$gf(".google-font-confirmation").remove();var a=($gf(this),$gf(this).attr("data-font_name"));$gf("body").append('<div class="google-font-overlay"></div>'),$gf("body").append('<div class="google-font-confirmation"><div class="google-font-confirmation-header"><h3>Are you sure you want to remove this font?</h3></div><div class="google-font-message"><input type="button" id="" data-gfont_name="'+a+'" class="google-font-message-buttons google-font-message-delete gfont-buttons" value="Yes"/><input type="button" id="" class="google-font-message-buttons google-font-message-no-delete gfont-buttons" value="No"/></div><a href="javacript:void(0)" class="gfont-anchor-buttons gfont-buttons google-font-message-no-delete"><i class="dashicons dashicons-no-alt"></i></a></div>'),$gf(".google-font-overlay").fadeIn(100),$gf(".google-font-confirmation").fadeIn(100)}),$gf("body").on("click",".gfont-buttons",function(){if($gf(this).hasClass("google-font-message-delete")){var a=$gf(this).attr("data-gfont_name"),b={action:"delete_google_font",font_name:a,security:uavc.delete_google_fonts};$gf.post(ajaxurl,b,function(b){$gf(".font-delete").each(function(b,c){var d=$gf(this),e=$gf(this).attr("data-font_name");e==a&&d.parent().remove()})})}$gf(".google-font-confirmation").fadeOut(200),$gf(".google-font-overlay").fadeOut(200)}),$gf("body").on("click",".update-google-font-button",function(){var a=$gf(this).attr("data-font_name"),b=$gf(this).parent(),c=new Array,d=new Array;$gf(b).find(".font-variant").each(function(a,b){var d={},e=$gf(b).find(".selected-variant-checkbox");d.variant_value=$gf(e).val(),$gf(e).is(":checked")?d.variant_selected=!0:d.variant_selected=!1,c.push(d)}),$gf(b).find(".font-subset").each(function(a,b){var c={},e=$gf(b).find(".selected-subset-checkbox");c.subset_value=$gf(e).val(),$gf(e).is(":checked")?c.subset_selected=!0:c.subset_selected=!1,d.push(c)});var e={action:"update_google_font",font_name:a,variants:c,subsets:d,security:uavc.update_google_fonts};$gf(this).next(".fspinner").addClass("fspinner-show"),$gf.post(ajaxurl,e,function(a){$gf(".fspinner").removeClass("fspinner-show")})}),$gf("body").on("click",".selected-font-top",function(){return $gf(this).hasClass("fopened")?($gf(this).parent().find(".selected-font-content").slideUp(200),void $gf(this).removeClass("fopened")):($gf(".selected-font .selected-font-content").slideUp(200),$gf(".selected-font-top").removeClass("fopened"),$gf(this).addClass("fopened"),void $gf(this).parent().find(".selected-font-content").slideToggle(200))}),get_google_fonts()}),$gf(window).scroll(function(){if($gf(window).height()+$gf(window).scrollTop()==$gf(document).height()){var a=$gf("#search_gfont").val();""==a&&get_google_fonts()}}),$gf(document).ready(function(){var a,b=500;$gf("#search_gfont").keyup(function(){clearTimeout(a),a=setTimeout(search_gfont,b)}),$gf("#search_gfont").keydown(function(){clearTimeout(a)})}),$gf(document).ready(function(){var a=jQuery(".fonts-selected-list"),b=jQuery(window),c=a.offset();b.scroll(function(){b.scrollTop()+35+15>c.top?a.addClass("uagffixed"):a.removeClass("uagffixed")})});