function dtResizeSquare(a,b,c){var d,e,f,g;return arguments.callee.dtDefIndex||(arguments.callee.dtDefIndex=dtGetDefaultIndex()),g=arguments.callee.dtDefIndex,a||(a=g),f=the7mbImageRatios[a].ratio,a<g?(e=parseInt(Math.round(b/f)),d=parseInt(Math.round(f*e))):a==g?(d=b,e=c):a>g&&(d=parseInt(Math.round(f*c)),e=parseInt(Math.round(d/f))),{w:d,h:e,desc:the7mbImageRatios[a].desc}}function dtGetDefaultIndex(){for(var a=the7mbImageRatios.length,b=1,c=1;c<=a;c++)if(1==the7mbImageRatios[c].ratio){b=c;break}return b}jQuery(document).ready(function(a){function b(a,b){1==b?a.show():a.animate({opacity:"1"},{queue:!1,duration:500}).slideDown(500)}function c(a){a.animate({opacity:"0"},{queue:!1,duration:500}).slideUp(500)}function d(d,e){var f=a("."+d.attr("data-name"));"show"==d.attr("value")&&d.is(":checked")||"show"==d.attr("value")&&d.is(":hidden")?b(f,e):("hide"==d.attr("value")&&d.is(":checked")||"hide"==d.attr("value")&&d.is(":hidden"))&&c(f),d.is('input[type="checkbox"]')&&(d.is(":checked")?b(f,e):c(f))}function e(b){var c=a(b),d=a("> input",c);c.siblings("label").removeClass("act").find("input").removeAttr("checked"),d.attr("checked","checked"),c.addClass("act");var e=c.parents(".dt_tabs"),f=e.next(".dt_tabs-content");"all"==d.attr("value")?(a("> div",f).hide(),a("> .dt_tab-all",f).show(),a("> .dt_arrange-by",e).not(".hide-if-js").hide(),f.removeClass("except only")):"only"==d.attr("value")?(a("> div",f).hide(),a("> .dt_tab-select",f).show(),a("> .dt_arrange-by",e).not(".hide-if-js").show(),f.removeClass("except").addClass("only")):"except"==d.attr("value")&&(a("> div",f).hide(),a("> .dt_tab-select",f).show(),a("> .dt_arrange-by",e).not(".hide-if-js").show(),f.removeClass("only").addClass("except")),"albums"==d.attr("value")?(a("> .dt_tab-select > div",f).hide(),a("> .dt_tab-select > .dt_tab-items",f).show()):"category"==d.attr("value")&&(a("> .dt_tab-select > div",f).hide(),a("> .dt_tab-select > .dt_tab-categories",f).show())}function f(b){var c=a(b),d=a("> input",c);"checked"==d.attr("checked")?(d.removeAttr("checked"),c.removeClass("act")):(d.attr("checked","checked"),c.addClass("act"))}a(".dt_radio-img label input:checked").parent("label").addClass("act").siblings("label").removeClass("act"),a(".dt_radio-img label").on("click",function(){a(this).addClass("act").siblings("label").removeClass("act")}),a(".dt_switcher input:checked").each(function(){d(a(this),!0)}),a(".dt_switcher").on("change",function(b){d(a(" > input",b.currentTarget))}),a(".dt_advanced input[value=show]").each(function(){a(this).parent().addClass("act"),d(a(this),!0)}),window.the7ShowAdvancedMetaFields=function(a){var b=a.find("> input:hidden");a.addClass("act"),b.attr("value","show"),d(b)},window.the7HideAdvancedMetaFields=function(a){var b=a.find("> input:hidden");a.removeClass("act"),b.attr("value","hide"),d(b)},window.the7ToggleAdvancedMetaFields=function(a){"show"===a.find("> input:hidden").attr("value")?the7HideAdvancedMetaFields(a):the7ShowAdvancedMetaFields(a)},a(".dt_advanced").on("click",function(b){b.preventDefault(),window.the7ToggleAdvancedMetaFields(a(this))}),a("label.dt_tab input:checked, label.dt_arrange input:checked").parent("label").addClass("act").siblings("label").removeClass("act"),a(".dt_tabs input:checked").each(function(){e(a(this).parent("label"))}),a(".dt_tabs label").on("click",function(b){b.preventDefault(),e(a(b.currentTarget))}),a(".dt_checkbox").each(function(){var b=a(this),c=a("> input",b);"checked"==c.attr("checked")?b.addClass("act"):b.removeClass("act")}),a(".dt_checkbox").on("click",function(b){b.preventDefault(),f(a(b.currentTarget))}),a(".dt_item-cover, .dt_tab-categories > .dt_list-item > span").on("click",function(b){f(a(b.currentTarget).parent().find(".dt_checkbox"))}),a(".dt_item-cover, .dt_tab-categories > .dt_list-item > span").on("mouseenter",function(){a(this).parent().find(".dt_checkbox").addClass("dt_hover")}).on("mouseleave",function(){a(this).parent().find(".dt_checkbox").removeClass("dt_hover")}),a(window).resize(function(){a(".dt_tabs-content").css({"max-height":a(window).height()-150})}),a(window).trigger("resize");var g={_isSlideshow:!1,_isTransOrNormal:!1,_headerTitle:a(".the7-mb-input-_dt_header_title input"),_headerBg:a(".the7-mb-input-_dt_header_background input"),_target:a(".the7-mb-input-_dt_header_header-below-slideshow"),init:function(){var b=this;b._headerTitle.on("change",function(){b._checkTitle(a(this).val()),b._changeTargetVisibility()}),b._headerBg.on("change",function(){b._checkBg(a(this).val()),b._changeTargetVisibility()}),b._checkTitle(b._headerTitle.filter(":checked").val()),b._checkBg(b._headerBg.filter(":checked").val()),b._changeTargetVisibility()},_checkTitle:function(a){this._isSlideshow="slideshow"===a},_checkBg:function(a){this._isTransOrNormal="normal"===a||"transparent"===a},_changeTargetVisibility:function(){this._isSlideshow&&this._isTransOrNormal?this._target.show():this._target.hide()}};g.init();var h={advSettings:null,metaBoxes:[],bootstrap:function(){var b=this;this.metaBoxes=this.findMetaBoxes(),this.advSettings=a("#adv-settings"),a('.the7-mb-input-_dt_header_title input[type="radio"]').on("change",function(c){b.handlePageTitleDependencies(a(this).val())}),a("body").on("change","#page_template, .editor-page-attributes__template select",function(){b.showMetaBoxesForTemplate(a(this).val())}),b.showMetaBoxesForTemplate(dtPageTemplate.templateName)},showMetaBoxesForTemplate:function(b){var c=[];for(var d in dtMetaboxes)dtMetaboxes[d].length&&dtMetaboxes[d].indexOf(b)===-1||c.push(d);this.showMetaBoxes(c),a(".dt_advanced").each(function(){window.the7HideAdvancedMetaFields(a(this))}),a('.the7-mb-input-_dt_header_title input[type="radio"]:checked').trigger("change"),this.showTemplateSpecificFields(b)},showMetaBoxes:function(b,c){var d=this;c||(c=this.metaBoxes),c.forEach(function(c){b.indexOf(c)===-1?a("#"+c).addClass("hide-if-js"):a("#"+c).removeClass("hide-if-js"),d.advSettings&&d.advSettings.find("#"+c+"-hide").prop("checked",b.indexOf(c)!==-1)})},findMetaBoxes:function(){return a('.postbox[id^="dt_page_box"]').map(function(){return this.id}).get()},showTemplateSpecificFields:function(b){a(".the7-mb-hidden-field.hide-if-js").each(function(c){var d=a(this),e=d.attr("data-show-on");"undefined"!=typeof e&&e!==!1&&(e=e.split(","),e.indexOf(b)===-1?d.hide():d.show())})},handlePageTitleDependencies:function(a){var b=["dt_page_box-slideshow_options","dt_page_box-display_slideshow","dt_page_box-fancy_header_options"],c={fancy:["dt_page_box-fancy_header_options"],slideshow:["dt_page_box-slideshow_options","dt_page_box-display_slideshow"]},d=[];"undefined"!=typeof c[a]&&(d=c[a]),this.showMetaBoxes(d,b)}};h.bootstrap()}),jQuery(function(a){a(".the7-mb-radio-hide-fields").each(function(){var b=a(this);b.parents(".the7-mb-field").first();b.find('input[type="radio"]').on("click",function(c){var d=a(this),e=d.attr("data-hide-fields"),f=jQuery.data(b,"hiddenFields")||[],g=f;e=e?e.split(","):new Array;for(var h=0;h<e.length;h++){a(".the7-mb-input-"+e[h]).closest(".the7-mb-field, .the7-mb-flickering-field").hide();var i=g.indexOf(e[h]);i>-1&&g.splice(i,1)}for(h=0;h<g.length;h++)a(".the7-mb-input-"+g[h]).closest(".the7-mb-field, .the7-mb-flickering-field").show();jQuery.data(b,"hiddenFields",e)}),b.find('input[type="radio"]:checked').trigger("click").trigger("change")}),a(".the7-mb-checkbox-hide-fields").each(function(){var b=a(this);b.parents(".the7-mb-field").first();b.find('input[type="checkbox"]').on("change",function(b){var c=a(this),d=c.attr("data-hide-fields");if(d=d?d.split(","):new Array,c.prop("checked"))for(e=0;e<d.length;e++)a(".the7-mb-input-"+d[e]).parent().show();else for(var e=0;e<d.length;e++)a(".the7-mb-input-"+d[e]).parent().hide()}),b.find('input[type="checkbox"]').trigger("change").trigger("change")}),a(".the7-mb-proportion_slider-wrapper .the7-mb-slider").each(function(){var b=a(this),c=b.parents(".the7-mb-proportion_slider-wrapper").find(".the7-mb-proportion_slider-prop-box"),d=parseInt(b.parents(".the7-mb-input").find("input").val()),e=80,f=80,g=407,h=[];for(var i in the7mbImageRatios)"length"!=i&&h.push(the7mbImageRatios[i].desc);var j=parseInt(Math.round(g/(h.length-1)));b.after('<div class="ui-slider-legend"><p style="width:'+j+'px;">'+h.join('</p><p style="width:'+j+'px;">')+'</p></div><div class="the7-mb-slider-prop-label"><span></span></div>');var k=dtResizeSquare(d,e,f),l=b.siblings(".the7-mb-slider-prop-label").find("span");c.css("width",k.w),c.css("height",k.h),l.text(k.desc),b.on("slide",function(a,b){var d=b.value,g=dtResizeSquare(d,e,f);c.css("width",g.w),c.css("height",g.h),l.text(g.desc)})})}),jQuery(document).ready(function(a){function b(b){var c=b.reduce(function(a,b){return a+'<option value="'+b.id+'">'+b.name+"</option>"},"");a("#the7-post-meta-presets").html(c)}function c(a){return!a.success}function d(a){try{alert(a.data.msg)}catch(a){console.log(a)}}function e(){return a(".the7-mb-field").find(":input").serializeArray()}function f(){var b=a("#the7-post-meta-presets").val(),c=a("#the7-post-meta-save-preset, #the7-post-meta-delete-preset, #the7-post-meta-apply-preset");b?c.removeAttr("disabled"):c.attr("disabled","disabled")}a("#the7-post-meta-apply-preset").on("click",function(b){b.preventDefault();var e=a("#post_ID").val(),f=a("#the7-post-meta-presets").val();if(""!==f){var g=a(this),h=g.text();g.addClass("active ready").text(the7MetaPresetsStrings.applyingPreset),a.post(ajaxurl,{action:"the7_meta_preset",preset_action:"apply_preset",_ajax_nonce:the7MetaPresetsNonces._ajax_nonce,postID:e,id:f}).done(function(a){return c(a)?(g.removeClass("active ready").text(h),void d(a)):void window.location.reload()}).fail(function(){g.removeClass("active ready").text(h)})}}),a("#the7-post-meta-delete-preset").on("click",function(e){e.preventDefault();var g=a("#post_ID").val(),h=a("#the7-post-meta-presets").val();""!==h&&a.post(ajaxurl,{action:"the7_meta_preset",preset_action:"delete_preset",_ajax_nonce:the7MetaPresetsNonces._ajax_nonce,postID:g,id:h}).done(function(a){if(c(a))return void d(a);try{b(a.data.presetsNames),f()}catch(a){console.log(a)}})}),a("#the7-post-meta-add-preset").on("click",function(g){g.preventDefault();var h=prompt(the7MetaPresetsStrings.enterName,"");if(h=h.trim()){var i=a("#post_ID").val();a.post(ajaxurl,{action:"the7_meta_preset",preset_action:"add_preset",_ajax_nonce:the7MetaPresetsNonces._ajax_nonce,postID:i,title:h,meta:e()}).done(function(a){if(c(a))return void d(a);try{b(a.data.presetsNames),f()}catch(a){console.log(a)}})}}),a("#the7-post-meta-save-preset").on("click",function(b){b.preventDefault();var f=a("#post_ID").val(),g=a("#the7-post-meta-presets").val();""!==g&&a.post(ajaxurl,{action:"the7_meta_preset",preset_action:"save_preset",_ajax_nonce:the7MetaPresetsNonces._ajax_nonce,postID:f,id:g,meta:e()}).done(function(a){return c(a)?void d(a):void alert(the7MetaPresetsStrings.presetSaved)})}),a("#the7-post-meta-save-defaults").on("click",function(b){b.preventDefault();var f=a("#post_ID").val();a.post(ajaxurl,{action:"the7_meta_preset",preset_action:"save_defaults",_ajax_nonce:the7MetaPresetsNonces._ajax_nonce,postID:f,meta:e()}).done(function(a){return c(a)?void d(a):void alert(the7MetaPresetsStrings.defaultsSaved)})})});